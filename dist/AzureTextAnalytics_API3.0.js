!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")(),o=function(e){try{return!!e()}catch(e){return!0}},i=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,c={f:s&&!a.call({1:2},1)?function(e){var t=s(this,e);return!!t&&t.enumerable}:a},u=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},l={}.toString,f=function(e){return l.call(e).slice(8,-1)},p="".split,d=o((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==f(e)?p.call(e,""):Object(e)}:Object,y=function(e){return d(function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}(e))},g=function(e){return"object"==typeof e?null!==e:"function"==typeof e},v=function(e,t){if(!g(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!g(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!g(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!g(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},h={}.hasOwnProperty,m=function(e,t){return h.call(e,t)},S=r.document,w=g(S)&&g(S.createElement),b=function(e){return w?S.createElement(e):{}},x=!i&&!o((function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a})),T=Object.getOwnPropertyDescriptor,P={f:i?T:function(e,t){if(e=y(e),t=v(t,!0),x)try{return T(e,t)}catch(e){}if(m(e,t))return u(!c.f.call(e,t),e[t])}},N=function(e){if(!g(e))throw TypeError(String(e)+" is not an object");return e},j=Object.defineProperty,E={f:i?j:function(e,t,n){if(N(e),t=v(t,!0),N(n),x)try{return j(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},O=i?function(e,t,n){return E.f(e,t,u(1,n))}:function(e,t,n){return e[t]=n,e},k=function(e,t){try{O(r,e,t)}catch(n){r[e]=t}return t},R=r["__core-js_shared__"]||k("__core-js_shared__",{}),A=Function.toString;"function"!=typeof R.inspectSource&&(R.inspectSource=function(e){return A.call(e)});var L,q,K,M,G=R.inspectSource,H=r.WeakMap,I="function"==typeof H&&/native code/.test(G(H)),C=t((function(e){(e.exports=function(e,t){return R[e]||(R[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),F=0,J=Math.random(),_=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++F+J).toString(36)},z=C("keys"),X={},D=r.WeakMap;if(I){var U=new D,V=U.get,W=U.has,B=U.set;L=function(e,t){return B.call(U,e,t),t},q=function(e){return V.call(U,e)||{}},K=function(e){return W.call(U,e)}}else{var Y=z[M="state"]||(z[M]=_(M));X[Y]=!0,L=function(e,t){return O(e,Y,t),t},q=function(e){return m(e,Y)?e[Y]:{}},K=function(e){return m(e,Y)}}var Q={set:L,get:q,has:K,enforce:function(e){return K(e)?q(e):L(e,{})},getterFor:function(e){return function(t){var n;if(!g(t)||(n=q(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},Z=t((function(e){var t=Q.get,n=Q.enforce,o=String(String).split("String");(e.exports=function(e,t,i,a){var s=!!a&&!!a.unsafe,c=!!a&&!!a.enumerable,u=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||m(i,"name")||O(i,"name",t),n(i).source=o.join("string"==typeof t?t:"")),e!==r?(s?!u&&e[t]&&(c=!0):delete e[t],c?e[t]=i:O(e,t,i)):c?e[t]=i:k(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||G(this)}))})),$=r,ee=function(e){return"function"==typeof e?e:void 0},te=function(e,t){return arguments.length<2?ee($[e])||ee(r[e]):$[e]&&$[e][t]||r[e]&&r[e][t]},ne=Math.ceil,re=Math.floor,oe=function(e){return isNaN(e=+e)?0:(e>0?re:ne)(e)},ie=Math.min,ae=function(e){return e>0?ie(oe(e),9007199254740991):0},se=Math.max,ce=Math.min,ue=function(e){return function(t,n,r){var o,i=y(t),a=ae(i.length),s=function(e,t){var n=oe(e);return n<0?se(n+t,0):ce(n,t)}(r,a);if(e&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},le={includes:ue(!0),indexOf:ue(!1)}.indexOf,fe=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype"),pe={f:Object.getOwnPropertyNames||function(e){return function(e,t){var n,r=y(e),o=0,i=[];for(n in r)!m(X,n)&&m(r,n)&&i.push(n);for(;t.length>o;)m(r,n=t[o++])&&(~le(i,n)||i.push(n));return i}(e,fe)}},de={f:Object.getOwnPropertySymbols},ye=te("Reflect","ownKeys")||function(e){var t=pe.f(N(e)),n=de.f;return n?t.concat(n(e)):t},ge=function(e,t){for(var n=ye(t),r=E.f,o=P.f,i=0;i<n.length;i++){var a=n[i];m(e,a)||r(e,a,o(t,a))}},ve=/#|\.prototype\./,he=function(e,t){var n=Se[me(e)];return n==be||n!=we&&("function"==typeof t?o(t):!!t)},me=he.normalize=function(e){return String(e).replace(ve,".").toLowerCase()},Se=he.data={},we=he.NATIVE="N",be=he.POLYFILL="P",xe=he,Te=P.f,Pe=function(e,t){var n,o,i,a,s,c=e.target,u=e.global,l=e.stat;if(n=u?r:l?r[c]||k(c,{}):(r[c]||{}).prototype)for(o in t){if(a=t[o],i=e.noTargetGet?(s=Te(n,o))&&s.value:n[o],!xe(u?o:c+(l?".":"#")+o,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;ge(a,i)}(e.sham||i&&i.sham)&&O(a,"sham",!0),Z(n,o,a,e)}},Ne=r.Promise,je=!!Object.getOwnPropertySymbols&&!o((function(){return!String(Symbol())})),Ee=je&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Oe=C("wks"),ke=r.Symbol,Re=Ee?ke:ke&&ke.withoutSetter||_,Ae=function(e){return m(Oe,e)||(je&&m(ke,e)?Oe[e]=ke[e]:Oe[e]=Re("Symbol."+e)),Oe[e]},Le=E.f,qe=Ae("toStringTag"),Ke=Ae("species"),Me=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Ge={},He=Ae("iterator"),Ie=Array.prototype,Ce=function(e,t,n){if(Me(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}},Fe={};Fe[Ae("toStringTag")]="z";var Je="[object z]"===String(Fe),_e=Ae("toStringTag"),ze="Arguments"==f(function(){return arguments}()),Xe=Je?f:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),_e))?n:ze?f(t):"Object"==(r=f(t))&&"function"==typeof t.callee?"Arguments":r},De=Ae("iterator"),Ue=function(e,t,n,r){try{return r?t(N(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&N(o.call(e)),t}},Ve=t((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,n,r,o,i){var a,s,c,u,l,f,p,d,y=Ce(n,r,o?2:1);if(i)a=e;else{if("function"!=typeof(s=function(e){if(null!=e)return e[De]||e["@@iterator"]||Ge[Xe(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(d=s)&&(Ge.Array===d||Ie[He]===d)){for(c=0,u=ae(e.length);u>c;c++)if((l=o?y(N(p=e[c])[0],p[1]):y(e[c]))&&l instanceof t)return l;return new t(!1)}a=s.call(e)}for(f=a.next;!(p=f.call(a)).done;)if("object"==typeof(l=Ue(a,y,p.value,o))&&l&&l instanceof t)return l;return new t(!1)}).stop=function(e){return new t(!0,e)}})),We=Ae("iterator"),Be=!1;try{var Ye=0,Qe={next:function(){return{done:!!Ye++}},return:function(){Be=!0}};Qe[We]=function(){return this},Array.from(Qe,(function(){throw 2}))}catch(e){}var Ze,$e,et,tt=Ae("species"),nt=te("document","documentElement"),rt=te("navigator","userAgent")||"",ot=/(iphone|ipod|ipad).*applewebkit/i.test(rt),it=r.location,at=r.setImmediate,st=r.clearImmediate,ct=r.process,ut=r.MessageChannel,lt=r.Dispatch,ft=0,pt={},dt=function(e){if(pt.hasOwnProperty(e)){var t=pt[e];delete pt[e],t()}},yt=function(e){return function(){dt(e)}},gt=function(e){dt(e.data)},vt=function(e){r.postMessage(e+"",it.protocol+"//"+it.host)};at&&st||(at=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return pt[++ft]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Ze(ft),ft},st=function(e){delete pt[e]},"process"==f(ct)?Ze=function(e){ct.nextTick(yt(e))}:lt&&lt.now?Ze=function(e){lt.now(yt(e))}:ut&&!ot?(et=($e=new ut).port2,$e.port1.onmessage=gt,Ze=Ce(et.postMessage,et,1)):!r.addEventListener||"function"!=typeof postMessage||r.importScripts||o(vt)||"file:"===it.protocol?Ze="onreadystatechange"in b("script")?function(e){nt.appendChild(b("script")).onreadystatechange=function(){nt.removeChild(this),dt(e)}}:function(e){setTimeout(yt(e),0)}:(Ze=vt,r.addEventListener("message",gt,!1)));var ht,mt,St,wt,bt,xt,Tt,Pt,Nt={set:at,clear:st},jt=P.f,Et=Nt.set,Ot=r.MutationObserver||r.WebKitMutationObserver,kt=r.process,Rt=r.Promise,At="process"==f(kt),Lt=jt(r,"queueMicrotask"),qt=Lt&&Lt.value;qt||(ht=function(){var e,t;for(At&&(e=kt.domain)&&e.exit();mt;){t=mt.fn,mt=mt.next;try{t()}catch(e){throw mt?wt():St=void 0,e}}St=void 0,e&&e.enter()},At?wt=function(){kt.nextTick(ht)}:Ot&&!ot?(bt=!0,xt=document.createTextNode(""),new Ot(ht).observe(xt,{characterData:!0}),wt=function(){xt.data=bt=!bt}):Rt&&Rt.resolve?(Tt=Rt.resolve(void 0),Pt=Tt.then,wt=function(){Pt.call(Tt,ht)}):wt=function(){Et.call(r,ht)});var Kt,Mt,Gt=qt||function(e){var t={fn:e,next:void 0};St&&(St.next=t),mt||(mt=t,wt()),St=t},Ht=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Me(t),this.reject=Me(n)},It={f:function(e){return new Ht(e)}},Ct=function(e,t){if(N(e),g(t)&&t.constructor===e)return t;var n=It.f(e);return(0,n.resolve)(t),n.promise},Ft=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Jt=r.process,_t=Jt&&Jt.versions,zt=_t&&_t.v8;zt?Mt=(Kt=zt.split("."))[0]+Kt[1]:rt&&(!(Kt=rt.match(/Edge\/(\d+)/))||Kt[1]>=74)&&(Kt=rt.match(/Chrome\/(\d+)/))&&(Mt=Kt[1]);var Xt,Dt,Ut,Vt,Wt,Bt,Yt,Qt=Mt&&+Mt,Zt=Nt.set,$t=Ae("species"),en="Promise",tn=Q.get,nn=Q.set,rn=Q.getterFor(en),on=Ne,an=r.TypeError,sn=r.document,cn=r.process,un=te("fetch"),ln=It.f,fn=ln,pn="process"==f(cn),dn=!!(sn&&sn.createEvent&&r.dispatchEvent),yn=xe(en,(function(){if(!(G(on)!==String(on))){if(66===Qt)return!0;if(!pn&&"function"!=typeof PromiseRejectionEvent)return!0}if(Qt>=51&&/native code/.test(on))return!1;var e=on.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[$t]=t,!(e.then((function(){}))instanceof t)})),gn=yn||!function(e,t){if(!t&&!Be)return!1;var n=!1;try{var r={};r[We]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}((function(e){on.all(e).catch((function(){}))})),vn=function(e){var t;return!(!g(e)||"function"!=typeof(t=e.then))&&t},hn=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;Gt((function(){for(var o=t.value,i=1==t.state,a=0;r.length>a;){var s,c,u,l=r[a++],f=i?l.ok:l.fail,p=l.resolve,d=l.reject,y=l.domain;try{f?(i||(2===t.rejection&&bn(e,t),t.rejection=1),!0===f?s=o:(y&&y.enter(),s=f(o),y&&(y.exit(),u=!0)),s===l.promise?d(an("Promise-chain cycle")):(c=vn(s))?c.call(s,p,d):p(s)):d(o)}catch(e){y&&!u&&y.exit(),d(e)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&Sn(e,t)}))}},mn=function(e,t,n){var o,i;dn?((o=sn.createEvent("Event")).promise=t,o.reason=n,o.initEvent(e,!1,!0),r.dispatchEvent(o)):o={promise:t,reason:n},(i=r["on"+e])?i(o):"unhandledrejection"===e&&function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Sn=function(e,t){Zt.call(r,(function(){var n,r=t.value;if(wn(t)&&(n=Ft((function(){pn?cn.emit("unhandledRejection",r,e):mn("unhandledrejection",e,r)})),t.rejection=pn||wn(t)?2:1,n.error))throw n.value}))},wn=function(e){return 1!==e.rejection&&!e.parent},bn=function(e,t){Zt.call(r,(function(){pn?cn.emit("rejectionHandled",e):mn("rejectionhandled",e,t.value)}))},xn=function(e,t,n,r){return function(o){e(t,n,o,r)}},Tn=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,hn(e,t,!0))},Pn=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw an("Promise can't be resolved itself");var o=vn(n);o?Gt((function(){var r={done:!1};try{o.call(n,xn(Pn,e,r,t),xn(Tn,e,r,t))}catch(n){Tn(e,r,n,t)}})):(t.value=n,t.state=1,hn(e,t,!1))}catch(n){Tn(e,{done:!1},n,t)}}};yn&&(on=function(e){!function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation")}(this,on,en),Me(e),Xt.call(this);var t=tn(this);try{e(xn(Pn,this,t),xn(Tn,this,t))}catch(e){Tn(this,t,e)}},(Xt=function(e){nn(this,{type:en,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(e,t,n){for(var r in t)Z(e,r,t[r],n);return e}(on.prototype,{then:function(e,t){var n,r,o,i=rn(this),a=ln((n=on,void 0===(o=N(this).constructor)||null==(r=N(o)[tt])?n:Me(r)));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=pn?cn.domain:void 0,i.parent=!0,i.reactions.push(a),0!=i.state&&hn(this,i,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),Dt=function(){var e=new Xt,t=tn(e);this.promise=e,this.resolve=xn(Pn,e,t),this.reject=xn(Tn,e,t)},It.f=ln=function(e){return e===on||e===Ut?new Dt(e):fn(e)},"function"==typeof Ne&&(Vt=Ne.prototype.then,Z(Ne.prototype,"then",(function(e,t){var n=this;return new on((function(e,t){Vt.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof un&&Pe({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Ct(on,un.apply(r,arguments))}}))),Pe({global:!0,wrap:!0,forced:yn},{Promise:on}),Bt=en,Yt=!1,(Wt=on)&&!m(Wt=Yt?Wt:Wt.prototype,qe)&&Le(Wt,qe,{configurable:!0,value:Bt}),function(e){var t=te(e),n=E.f;i&&t&&!t[Ke]&&n(t,Ke,{configurable:!0,get:function(){return this}})}(en),Ut=te(en),Pe({target:en,stat:!0,forced:yn},{reject:function(e){var t=ln(this);return t.reject.call(void 0,e),t.promise}}),Pe({target:en,stat:!0,forced:yn},{resolve:function(e){return Ct(this,e)}}),Pe({target:en,stat:!0,forced:gn},{all:function(e){var t=this,n=ln(t),r=n.resolve,o=n.reject,i=Ft((function(){var n=Me(t.resolve),i=[],a=0,s=1;Ve(e,(function(e){var c=a++,u=!1;i.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,i[c]=e,--s||r(i))}),o)})),--s||r(i)}));return i.error&&o(i.value),n.promise},race:function(e){var t=this,n=ln(t),r=n.reject,o=Ft((function(){var o=Me(t.resolve);Ve(e,(function(e){o.call(t,e).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});const Nn="=== USTS-IATA: ";metadata={systemName:"ImmersionAzureTextAnalytics",displayName:"Azure Text Analytics",description:"Azure Text Analytics",configuration:{"Subscription Key":{displayName:"Subscription Key",type:"string",required:!0},"Service Endpoint":{displayName:"Service Endpoint",type:"string",required:!0}}},ondescribe=async function({configuration:e}){postSchema({objects:{Sentiment:{displayName:"Sentiment Analytics",description:"Text Analytics - Sentiment Analysis v3.0",properties:{language:{displayName:"Language",type:"string"},value:{displayName:"Value",type:"extendedString",extendedType:"k2.com/2019/memo"},text:{displayName:"Text",type:"extendedString",extendedType:"k2.com/2019/memo"},sentiment:{displayName:"Sentiment",type:"string"},positive:{displayName:"positive",type:"decimal"},neutral:{displayName:"neutral",type:"decimal"},negative:{displayName:"negative",type:"decimal"}},methods:{GetSentiment:{displayName:"Get Sentiment",type:"read",inputs:["language","value"],requiredInputs:["value"],outputs:["sentiment","positive","neutral","negative"]},GetSentiments:{displayName:"Get Sentiments",type:"list",inputs:["language","value"],requiredInputs:["value"],outputs:["text","sentiment","positive","neutral","negative"]}}},Language:{displayName:"Language Analysis",description:"Language Analysis",properties:{text:{displayName:"Text",type:"extendedString",extendedType:"k2.com/2019/memo"},language:{displayName:"Language",type:"string"},code:{displayName:"iso 639-1 Name",type:"string"},score:{displayName:"Confidence Score",type:"decimal"}},methods:{GetLanguage:{displayName:"Get Language",type:"read",inputs:["text"],requiredInputs:["text"],outputs:["language","code","score"]}}},KeyPhrases:{displayName:"Key Phrases Analytics",description:"Text Analytics - Key Phrases Analysis v3.0",properties:{language:{displayName:"Language",type:"string"},value:{displayName:"value",type:"extendedString",extendedType:"k2.com/2019/memo"},keyPhrases:{displayName:"keyPhrases",type:"string"}},methods:{GetKeyPhrasesString:{displayName:"Get Key Phrases",type:"read",inputs:["language","value"],requiredInputs:["value"],outputs:["keyPhrases"]},ListKeyPhrases:{displayName:"List Key Prases",type:"list",inputs:["language","value"],requiredInputs:["value"],outputs:["keyPhrases"]}}},Entities:{displayName:"Entities Analysis",description:"Entities Analysis",properties:{value:{displayName:"Value",type:"extendedString",extendedType:"k2.com/2019/memo"},language:{displayName:"Language",type:"string"},text:{displayName:"Text",type:"string"},category:{displayName:"Category",type:"string"},score:{displayName:"Confidence Score",type:"decimal"}},methods:{GetEntities:{displayName:"Get Entities",type:"list",inputs:["language","value"],requiredInputs:["value"],outputs:["text","category","score"]}}}}})},onexecute=async function({objectName:e,methodName:t,parameters:n,properties:r,configuration:o,schema:i}){switch(e){case"Sentiment":await async function(e,t,n,r){switch(e){case"GetSentiment":await function(e,t,n){return new Promise((e,r)=>{var o=new XMLHttpRequest;console.log(Nn+"onexecuteGetSentiment"),o.onreadystatechange=function(){try{if(4!==o.readyState)return;if(200!==o.status)throw new Error("Failed with status "+o.status);var t=JSON.parse(o.responseText);console.log(Nn+"Response"+o.responseText),postResult({sentiment:t.documents[0].sentiment,positive:t.documents[0].confidenceScores.positive,neutral:t.documents[0].confidenceScores.neutral,negative:t.documents[0].confidenceScores.negative}),e()}catch(e){r(e)}};var i=String(n["Service Endpoint"]);"/"!==i.slice(-1)&&(i+="/"),i+="text/analytics/v3.0/sentiment",o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Ocp-Apim-Subscription-Key",String(n["Subscription Key"]));var a=JSON.stringify({documents:[{language:t.language,id:"1",text:t.value}]});console.log(Nn+"body: "+a),o.send(a)})}(0,t,r);break;case"GetSentiments":await function(e,t,n){return new Promise((e,r)=>{var o=new XMLHttpRequest;console.log(Nn+"onexecuteGetSentimentBySentence"),o.onreadystatechange=function(){try{if(4!==o.readyState)return;if(200!==o.status)throw new Error("Failed with status "+o.status);var t=JSON.parse(o.responseText);console.log(Nn+"Response"+o.responseText),postResult(t.documents[0].sentences.map(e=>({text:e.text,sentiment:e.sentiment,positive:e.confidenceScores.positive,neutral:e.confidenceScores.neutral,negative:e.confidenceScores.negative}))),e()}catch(e){r(e)}};var i=String(n["Service Endpoint"]);"/"!==i.slice(-1)&&(i+="/"),i+="text/analytics/v3.0/sentiment",o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Ocp-Apim-Subscription-Key",String(n["Subscription Key"]));var a=JSON.stringify({documents:[{language:t.language,id:"1",text:t.value}]});console.log(Nn+"body: "+a),o.send(a)})}(0,t,r);break;default:throw new Error("The method "+e+" is not supported.")}}(t,r,0,o);break;case"Language":await async function(e,t,n,r){switch(e){case"GetLanguage":await function(e,t,n){return new Promise((e,r)=>{var o=new XMLHttpRequest;console.log(Nn+"onexecuteGetLanguage"),o.onreadystatechange=function(){try{if(4!==o.readyState)return;if(200!==o.status)throw new Error("Failed with status "+o.status);var t=JSON.parse(o.responseText);console.log(Nn+"Response"+o.responseText),postResult({language:t.documents[0].detectedLanguage.name,code:t.documents[0].detectedLanguage.iso6391Name,score:t.documents[0].detectedLanguage.confidenceScore}),e()}catch(e){r(e)}};var i=String(n["Service Endpoint"]);"/"!==i.slice(-1)&&(i+="/"),i+="text/analytics/v3.0/languages",o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Ocp-Apim-Subscription-Key",String(n["Subscription Key"]));var a=JSON.stringify({documents:[{id:"1",text:t.text}]});console.log(Nn+"body: "+a),o.send(a)})}(0,t,r);break;default:throw new Error("The method "+e+" is not supported.")}}(t,r,0,o);break;case"KeyPhrases":await async function(e,t,n,r){switch(e){case"GetKeyPhrasesString":await function(e,t,n){return new Promise((e,r)=>{var o=new XMLHttpRequest;console.log(Nn+"onexecuteGetKeyPhrases"),o.onreadystatechange=function(){try{if(4!==o.readyState)return;if(200!==o.status)throw new Error("Failed with status "+o.status);var t=JSON.parse(o.responseText);console.log(Nn+"Response"+o.responseText);var n=",",i=t.documents[0].keyPhrases;for(var a in i)n+=","+i[a];postResult({keyPhrases:n.slice(1)}),e()}catch(e){r(e)}};var i=String(n["Service Endpoint"]);"/"!==i.slice(-1)&&(i+="/"),i+="text/analytics/v3.0/keyPhrases",o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Ocp-Apim-Subscription-Key",String(n["Subscription Key"]));var a=JSON.stringify({documents:[{language:t.language,id:"1",text:t.value}]});console.log(Nn+"body: "+a),o.send(a)})}(0,t,r);break;case"ListKeyPhrases":await function(e,t,n){return new Promise((e,r)=>{var o=new XMLHttpRequest;console.log(Nn+"onexecuteListKeyPhrases"),o.onreadystatechange=function(){try{if(4!==o.readyState)return;if(200!==o.status)throw new Error("Failed with status "+o.status);var t=JSON.parse(o.responseText);console.log(Nn+"Response"+o.responseText);var n=t.documents[0].keyPhrases;for(var i in n)postResult({keyPhrases:n[i]});e()}catch(e){r(e)}};var i=String(n["Service Endpoint"]);"/"!==i.slice(-1)&&(i+="/"),i+="text/analytics/v3.0/keyPhrases",o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Ocp-Apim-Subscription-Key",String(n["Subscription Key"]));var a=JSON.stringify({documents:[{language:t.language,id:"1",text:t.value}]});console.log(Nn+"body: "+a),o.send(a)})}(0,t,r);break;default:throw new Error("The method "+e+" is not supported.")}}(t,r,0,o);break;case"Entities":await async function(e,t,n,r){switch(e){case"GetEntities":await function(e,t,n){return new Promise((e,r)=>{var o=new XMLHttpRequest;console.log(Nn+"onexecuteGetEntities"),o.onreadystatechange=function(){try{if(4!==o.readyState)return;if(200!==o.status)throw new Error("Failed with status "+o.status);var t=JSON.parse(o.responseText);console.log(Nn+"Response"+o.responseText),postResult(t.documents[0].entities.map(e=>({text:e.text,category:e.category,score:e.confidenceScore}))),e()}catch(e){r(e)}};var i=String(n["Service Endpoint"]);"/"!==i.slice(-1)&&(i+="/"),i+="text/analytics/v3.0/entities/recognition/general",o.open("POST",i),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Ocp-Apim-Subscription-Key",String(n["Subscription Key"]));var a=JSON.stringify({documents:[{id:"1",text:t.value}]});console.log(Nn+"body: "+a),o.send(a)})}(0,t,r);break;default:throw new Error("The method "+e+" is not supported.")}}(t,r,0,o);break;default:throw new Error("The object "+e+" is not supported.")}}}();
//# sourceMappingURL=index.js.map
